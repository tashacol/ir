<!DOCTYPE html>   
<html lang="fa" dir="rtl">  
<head>  
  <meta charset="UTF-8">  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  
  <!-- متاهای سئو -->  
  <meta name="keywords" content="موسسه تعالی اندیشه و رشد, فرهنگ دینی, سبک زندگی اسلامی, تربیت کودکان, آموزش قرآن">  
  <meta name="description" content="موسسه تعالی اندیشه و رشد با هدف ترویج فرهنگ دینی و اسلامی فعالیت می‌کند.">  
  <meta name="author" content="موسسه تعالی اندیشه و رشد">  
    
  <title>موسسه تعالی اندیشه و رشد</title>  
    
  <!-- فاویکن و تنظیمات برنامه وب -->
  <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/tashacol/ir/refs/heads/main/favicon%20(1).ico">
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-title" content="موسسه تعالی">
  <meta name="application-name" content="موسسه تعالی">
  <meta name="theme-color" content="#ffffff">
    
  <!-- لینک به Font Awesome برای آیکن‌ها -->  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"   
        integrity="sha512-Fo3rlrZj/k7ujTTXRNXwKd86F9f5N5qyfYtm8tc27j1EcHVUZ9YplO1bNMRnkQeK2wXrmtygR8oSbL+qVf5Kug=="   
        crossorigin="anonymous" referrerpolicy="no-referrer" />  
    
  <style>  
    /* افزودن scroll-behavior برای اسکرول نرم */  
    html {  
      scroll-behavior: smooth;  
    }

    /* افزودن فونت فارسی از طریق لینک مستقیم به فایل TTF */  
    @font-face {  
      font-family: 'IranNastaliq';  
      src: url('https://tashacol.github.io/ir/B%20Titr%20Bold_0.ttf') format('truetype');  
    }  
      
    /* ================================  
       استایل لودینگ مدرن  
    =================================== */  
    .loader-wrapper {  
      position: fixed;  
      top: 0;  
      left: 0;  
      width: 100%;  
      height: 100%;  
      background: #121212;  
      display: flex;  
      flex-direction: column;  
      align-items: center;  
      justify-content: center;  
      z-index: 9999;  
    }  
    .loader {  
      position: relative;  
      width: 80px;  
      height: 80px;  
    }  
    .loader::before, .loader::after {  
      content: "";  
      position: absolute;  
      border: 4px solid var(--accent-color);  
      border-radius: 50%;  
      animation: ripple 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;  
    }  
    .loader::after {  
      animation-delay: -0.75s;  
    }  
    @keyframes ripple {  
      0% {  
        top: 36px;  
        left: 36px;  
        width: 0;  
        height: 0;  
        opacity: 1;  
      }  
      100% {  
        top: 0;  
        left: 0;  
        width: 72px;  
        height: 72px;  
        opacity: 0;  
      }  
    }  
    .loader-text {  
      margin-top: 20px;  
      font-size: 1.2rem;  
      color: var(--accent-color);  
      letter-spacing: 2px;  
      animation: textPulse 1.5s ease-in-out infinite;  
    }  
    @keyframes textPulse {  
      0%, 100% { opacity: 0.8; transform: scale(0.95); }  
      50% { opacity: 1; transform: scale(1); }  
    }  
    .fade-out {  
      animation: fadeOut 0.5s forwards;  
    }  
    @keyframes fadeOut {  
      0% { opacity: 1; }  
      100% { opacity: 0; visibility: hidden; }  
    }  
      
    /* ================================  
       سایر استایل‌های صفحه (بدون تغییر)  
    =================================== */  
    :root {  
      --primary-color: #1a2980;  
      --secondary-color: #26d0ce;  
      --accent-color: #ffeb3b;  
      --dark-bg: #000428;  
      --mid-bg: #004e92;  
      --text-color: #fff;  
      --card-bg: rgba(255, 255, 255, 0.1);  
      --card-border: rgba(255, 255, 255, 0.2);  
    }  
      
    * {  
      margin: 0;  
      padding: 0;  
      box-sizing: border-box;  
    }  
      
    body {  
      font-family: 'IranNastaliq', 'Tahoma', sans-serif;  
      color: var(--text-color);  
      position: relative;  
      min-height: 100vh;  
      overflow-x: hidden;  
    }  
      
    body::before {  
      content: "";  
      position: fixed;  
      top: 0;  
      left: 0;  
      width: 100%;  
      height: 100%;  
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));  
      background-size: 400% 400%;  
      animation: gradientBG 15s ease infinite;  
      will-change: background-position;  
      transform: translateZ(0);  
      z-index: -1;  
    }  
      
    @keyframes gradientBG {  
      0%   { background-position: 0% 50%; }  
      50%  { background-position: 100% 50%; }  
      100% { background-position: 0% 50%; }  
    }  
      
    @keyframes slideInDown {  
      0% { opacity: 0; transform: translateY(-50px); }  
      100% { opacity: 1; transform: translateY(0); }  
    }  
      
    @keyframes fadeInUp {  
      0% { opacity: 0; transform: translateY(20px); }  
      100% { opacity: 1; transform: translateY(0); }  
    }  
      
    header {  
      position: fixed;  
      top: 0;  
      left: 0;  
      width: 100%;  
      background: linear-gradient(135deg, var(--dark-bg), var(--mid-bg));  
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);  
      z-index: 10;  
      animation: slideInDown 1s ease-out;  
    }  
      
    .header-container {  
      max-width: 1200px;  
      margin: 0 auto;  
      padding: 1rem 1.5rem;  
      display: flex;  
      align-items: center;  
      justify-content: space-between;  
    }  
      
    header h1 {  
      font-size: 1.8rem;  
      letter-spacing: 1px;  
      animation: slideInDown 1s ease-out;  
    }  
      
    .nav-menu {  
      display: flex;  
      gap: 20px;  
      animation: slideInDown 1s ease-out;  
    }  
      
    .nav-menu a {  
      color: var(--accent-color);  
      text-decoration: none;  
      font-weight: bold;  
      transition: transform 0.3s, color 0.3s;  
    }  
      
    .nav-menu a:hover {  
      color: var(--secondary-color);  
      transform: scale(1.05);  
    }  
      
    .menu-toggle {  
      display: none;  
      background: none;  
      border: none;  
      cursor: pointer;  
      margin-left: 10px;  
    }  
      
    .hamburger {  
      width: 25px;  
      height: 2px;  
      background: var(--accent-color);  
      position: relative;  
      transition: background 0.3s;  
    }  
      
    .hamburger::before,  
    .hamburger::after {  
      content: "";  
      position: absolute;  
      width: 25px;  
      height: 2px;  
      background: var(--accent-color);  
      transition: transform 0.3s;  
    }  
      
    .hamburger::before {  
      top: -8px;  
    }  
      
    .hamburger::after {  
      top: 8px;  
    }  
      
    @media (max-width: 768px) {  
      .nav-menu {  
        position: fixed;  
        top: 60px;  
        right: -100%;  
        background: linear-gradient(135deg, var(--dark-bg), var(--mid-bg));  
        flex-direction: column;  
        gap: 10px;  
        padding: 1rem;  
        border-radius: 8px;  
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);  
        transition: right 0.3s ease;  
      }  
      .nav-menu.active {  
        right: 10px;  
      }  
      .menu-toggle {  
        display: block;  
      }  
    }  
      
    main {  
      padding-top: 120px;  
      max-width: 1200px;  
      margin: auto;  
      padding: 120px 20px 40px 20px;  
      display: flex;  
      flex-direction: column;  
      gap: 40px;  
    }  
      
    .section-card {  
      background: var(--card-bg);  
      border: 1px solid var(--card-border);  
      border-radius: 15px;  
      backdrop-filter: blur(5px);  
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);  
      overflow: hidden;  
      transition: transform 0.5s ease, box-shadow 0.5s ease;  
      padding: 20px;  
      opacity: 0;  
      animation: fadeInUp 0.8s ease forwards;  
    }  
      
    main section:nth-child(1) { animation-delay: 0.3s; }  
    main section:nth-child(2) { animation-delay: 0.5s; }  
    main section:nth-child(3) { animation-delay: 0.7s; }  
    main section:nth-child(4) { animation-delay: 0.9s; }  
    main section:nth-child(5) { animation-delay: 1.1s; }  
      
    .section-card:hover {  
      transform: translateY(-10px) scale(1.02);  
      box-shadow: 0 12px 24px rgba(0,0,0,0.4);  
    }  
      
    .section-header {  
      background: linear-gradient(135deg, rgba(0,0,0,0.3), rgba(0,0,0,0.5));  
      padding: 1rem;  
      text-align: center;  
      font-size: 1.5rem;  
      font-weight: bold;  
      color: var(--accent-color);  
      position: relative;  
      margin-bottom: 20px;  
      border-radius: 8px;  
      animation: fadeInUp 0.8s ease forwards;  
    }  
      
    .section-header::after {  
      content: "";  
      position: absolute;  
      bottom: -5px;  
      left: 50%;  
      transform: translateX(-50%);  
      width: 50%;  
      height: 4px;  
      background: var(--accent-color);  
      border-radius: 2px;  
    }  
      
    .section-content {  
      padding: 0 10px;  
      font-size: 1rem;  
      line-height: 1.6;  
    }  
    
    /* تغییر سایز متون برای بخش‌های مشخصات موسسه، اهداف و مأموریت‌ها و فعالیت‌ها */  
    #about .section-content,  
    #mission .section-content,  
    #activities .section-content {  
      font-size: 14px;  
    }  
      
    .section-content ul {  
      list-style: none;  
      display: flex;  
      flex-direction: column;  
      gap: 10px;  
      padding: 0;  
    }  
      
    .section-content ul li {  
      background: rgba(255,255,255,0.1);  
      padding: 10px;  
      border-radius: 8px;  
      transition: background 0.3s, transform 0.3s;  
    }  
      
    .section-content ul li:hover {  
      background: rgba(255,235,59,0.2);  
      transform: translateX(5px);  
    }  
      
    .section-content a {  
      color: var(--accent-color);  
      text-decoration: none;  
      font-weight: bold;  
      transition: color 0.3s;  
    }  
      
    .section-content a:hover {  
      color: var(--secondary-color);  
    }  
      
    .menu-grid {  
      display: grid;  
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));  
      gap: 20px;  
    }  
      
    .menu-item {  
      background: var(--card-bg);  
      border: 1px solid var(--card-border);  
      border-radius: 10px;  
      padding: 15px;  
      text-align: center;  
      transition: transform 0.3s, box-shadow 0.3s;  
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);  
    }  
      
    .menu-item:hover {  
      transform: translateY(-5px) scale(1.03);  
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);  
    }  
      
    .menu-item i {  
      font-size: 1.8rem;  
      margin-bottom: 10px;  
      display: block;  
      color: var(--accent-color);  
      transition: color 0.3s;  
    }  
      
    .menu-item:hover i {  
      color: var(--secondary-color);  
    }  
      
    .menu-item span {  
      font-weight: bold;  
      color: var(--accent-color);  
      transition: color 0.3s;  
    }  
      
    .menu-item:hover span {  
      color: var(--secondary-color);  
    }  
      
    @media (max-width: 768px) {  
      main {  
        padding: 120px 10px 40px 10px;  
      }  
      .section-card {  
        margin: 0 10px;  
      }  
    }  
      
    footer {  
      text-align: center;  
      padding: 20px;  
      background: linear-gradient(135deg, var(--dark-bg), var(--mid-bg));  
      color: var(--text-color);  
      font-size: 1rem;  
      box-shadow: 0 -4px 8px rgba(0,0,0,0.3);  
      border-top: 3px solid var(--accent-color);  
      margin-top: 40px;  
    }  
  </style>  

  <!-- ===============================
       کدهای مربوط به پنجره پاپ‌آپ اخبار
       (بدون تغییر سایر بخش‌های سایت)
  ================================ -->
  <!-- کتابخانه SheetJS برای پردازش فایل اکسل -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- لینک به فونت Vazir (برای پیام‌های چت) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v28.1.0/dist/font-face.css">
  <style>
    /* استایل‌های پنجره پاپ‌آپ اخبار */
    #chatPopup {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: fadeIn 0.5s ease;
      overscroll-behavior: contain;  /* جلوگیری از انتقال اسکرول به عناصر پشت صحنه */
    }
    .popupContent {
      position: relative;
      width: 360px;
      max-width: 95%;
      height: 580px;
      background: rgba(255, 255, 255, 0.7); /* پس‌زمینه مدرن با شفافیت مناسب */
      backdrop-filter: blur(10px); /* افکت شیشه‌ای (glassmorphism) */
      border: 1px solid rgba(255, 255, 255, 0.3); /* حاشیه ملایم */
      border-radius: 15px;
      box-shadow: 0 15px 30px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: perspective(600px) rotateX(5deg);
      animation: slideDown 0.6s ease forwards;
      transition: transform 0.3s ease;
    }
    .popupHeader {
      background: linear-gradient(45deg, #5563DE, #74ABE2);
      color: #fff;
      padding: 20px;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .popupBody {
      flex: 1;
      background: rgba(255,255,255,0.6); /* پس‌زمینه مدرن برای کادر پیام‌ها */
      backdrop-filter: blur(5px); /* افکت شیشه‌ای */
      overflow-y: auto;
      padding: 15px;
      position: relative;
      overscroll-behavior: contain;  /* جلوگیری از انتقال اسکرول به صفحه اصلی */
    }
    /* دکمه بستن جدید: دکمه گرد، سه بعدی، با حاشیه سه بعدی، قرمز با ضربدر سفید */
    .popupFooter {
      position: absolute;
      left: 10px;
      bottom: 10px;
      width: 50px;
      height: 50px;
      background: #e74c3c;
      border: 2px solid #c0392b;
      border-radius: 50%;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .popupFooter:hover {
      transform: scale(1.1);
    }
    .popupFooter svg {
      fill: #fff;
      width: 24px;
      height: 24px;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideDown {
      0% { transform: perspective(600px) rotateX(15deg) translateY(-30px); opacity: 0; }
      100% { transform: perspective(600px) rotateX(0deg) translateY(0); opacity: 1; }
    }
    .spinner {
      position: relative;
      width: 40px;
      height: 40px;
      margin: 0 auto 10px;
    }
    .spinner:before, .spinner:after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #74ABE2;
      opacity: 0.6;
      animation: bounce 0.8s infinite ease-in-out;
    }
    .spinner:after {
      animation-delay: -0.4s;
    }
    @keyframes bounce {
      0%, 100% { transform: scale(0); }
      50% { transform: scale(1); }
    }
    .loading p {
      text-align: center;
      color: #555;
      font-size: 14px;
    }
    .chat-message {
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 15px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .chat-message:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    /* ویرایش: نمایش تصویر خبر به صورت مستطیل با حاشیه‌های گرد */
    .chat-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .chat-image:hover {
      transform: scale(1.1);
    }
    .chat-image.viewed {
      /* در صورت نیاز استایل اضافه شود */
    }
    /* ویرایش: متن تیتر خبر و توضیحات راستچین شوند */  
    .chat-title {
      font-weight: bold;
      font-size: 16px;
      color: #333;
      text-align: right;
      margin-bottom: 5px;
    }
    .chat-desc {
      font-size: 14px;
      color: #666;
      text-align: right;
    }
    .more-details {
      display: inline-block;
      margin-top: 12px;
      padding: 8px 16px;
      background: linear-gradient(45deg, #5563DE, #74ABE2);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      text-decoration: none;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      align-self: flex-end;
    }
    .more-details:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    #imageModal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      animation: fadeIn 0.5s ease;
      padding: 20px;
    }
    .imageModalContent {
      position: relative;
      max-width: 90%;
      max-height: 90%;
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
      border-radius: 15px;
      overflow: hidden;
    }
    #modalImage {
      width: 100%;
      height: auto;
      display: block;
    }
    .closeModal {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 71, 87, 0.8);
      color: #fff;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease;
    }
    .closeModal:hover {
      transform: scale(1.1);
    }
    /* تنظیم فونت اختصاصی برای پیام‌ها به فونت فارسی Vazir */
    .chat-message, .chat-message * {
      font-family: 'Vazir', Tahoma, sans-serif !important;
    }
  </style>
</head>  
<body>  
  <!-- لایه لودینگ مدرن (تا زمان بارگذاری کامل صفحه نمایش داده می‌شود) -->  
  <div class="loader-wrapper" id="loader">  
    <div class="loader"></div>  
    <div class="loader-text">در حال بارگذاری...</div>  
  </div>  
    
  <!-- هدر با منوی ناوبری و دکمه همبرگری -->  
  <header>  
    <div class="header-container">  
      <h1>موسسه تعالی اندیشه و رشد</h1>  
      <button class="menu-toggle" aria-label="Toggle Navigation">  
        <span class="hamburger"></span>  
      </button>  
      <nav class="nav-menu">  
        <a href="#menu">منو</a>  
        <a href="#about">مشخصات</a>  
        <a href="#mission">اهداف</a>  
        <a href="#activities">فعالیت‌ها</a>  
        <a href="#contact">تماس</a>  
      </nav>  
    </div>  
  </header>  
    
  <!-- محتوای اصلی -->  
  <main>  
    <!-- بخش منو (اولویت اول قرار گرفت) -->  
    <section id="menu" class="section-card">  
      <div class="section-header">منو</div>  
      <div class="section-content">  
        <div class="menu-grid">  
          <a href="http://tashacol.github.io/ir/daneshjoo.html" target="_blank" class="menu-item">
            <i class="fas fa-user-graduate"></i>
            <span>کاربری دانشجویان</span>
          </a>
          <a href="http://tashacol.github.io/ir/modir.html" onclick="window.open(this.href,'','width=800,height=600');return false;" class="menu-item">  
            <i class="fas fa-user-tie"></i>  
            <span>کاربری مسئولین</span>  
          </a>  
          <a href="http://tashacol.github.io/ir/sanj.html" target="_blank" class="menu-item">  
            <i class="fas fa-file-alt"></i>  
            <span>استعلام گواهی</span>  
          </a>  
          <a href="https://tashacol.github.io/ir/esabeqe.html" target="_blank" class="menu-item">  
            <i class="fas fa-history"></i>  
            <span>استعلام سوابق</span>  
          </a>  
          <a href="http://tashacol.github.io/ir/emza.html" target="_blank" class="menu-item">  
            <i class="fas fa-certificate"></i>  
            <span>درخواست گواهینامه</span>  
          </a>  
          <a href="https://tashacol.github.io/ir/nazar.html" target="_blank" class="menu-item">  
            <i class="fas fa-poll"></i>  
            <span>نظرسنجی دوره تربیت مربی</span>  
          </a>  
          <a href="https://tashacol.github.io/ir/poroje.html" target="_blank" class="menu-item">  
            <i class="fas fa-project-diagram"></i>  
            <span>پروژه دانش‌پذیران</span>  
          </a>  
          <a href="https://tashacol.github.io/ir/serche.html" target="_blank" class="menu-item">  
            <i class="fas fa-search"></i>  
            <span>جستجوی پیشرفته</span>  
          </a>  
        </div>  
      </div>  
    </section>  
      
    <!-- بخش مشخصات موسسه (در جایگاه دوم) -->  
    <section id="about" class="section-card">  
      <div class="section-header">مشخصات موسسه</div>  
      <div class="section-content">  
        <ul>  
          <li>شناسه ملی: 14013770611</li>  
          <li>شناسه خدمت الکترونیک: 17061695000</li>  
          <li>کد شناسایی در سازمان تبلیغات: 31605007</li>  
          <li>شماره ثبت: 391</li>  
          <li>ایمیل: <a href="mailto:irtashacol@gmail.com">irtashacol@gmail.com</a></li>  
          <li>ایتا: <a href="https://eitaa.com/irtaali" target="_blank">eitaa.com/irtaali</a></li>  
          <li>شماره مجوز: 1403136/32273</li>  
        </ul>  
      </div>  
    </section>  
      
    <!-- بخش اهداف و مأموریت‌ها -->  
    <section id="mission" class="section-card">  
      <div class="section-header">اهداف و مأموریت‌ها</div>  
      <div class="section-content">  
        <ul>  
          <li>بند ۱: بسترسازی برای تحقق و اشاعه ارزش‌های انقلاب اسلامی و سبک زندگی اسلامی</li>  
          <li>بند ۲: ترویج و توسعه فرهنگ دینی در جامعه اسلامی</li>  
          <li>بند ۳: توسعه گستره تولیدات و محصولات فاخر فرهنگ دینی</li>  
          <li>بند ۴: بارور نمودن اوقات فراغت جوانان</li>  
          <li>بند ۵: توانمندسازی طلاب، مبلغین، روحانیون، معلمان و فرهنگیان</li>  
        </ul>  
      </div>  
    </section>  
      
    <!-- بخش فعالیت‌ها -->  
    <section id="activities" class="section-card">  
      <div class="section-header">فعالیت‌ها</div>  
      <div class="section-content">  
        <ul>  
          <li>برگزاری کلاس‌های قرآن، اخلاق، عقاید و احکام در طول سال</li>  
          <li>گردهمایی‌ها، نمایشگاه‌ها، تبلیغات محیطی و راه‌اندازی وب‌سایت</li>  
          <li>تدوین و انتشار کتاب، سی‌دی، نشریات و جزوات مذهبی</li>  
          <li>برگزاری فعالیت‌های فرهنگی در مناسبت‌های مذهبی و انقلابی</li>  
          <li>دوره‌های آموزشی در زمینه خانواده، تربیت دینی و مهارت‌های زندگی</li>  
        </ul>  
      </div>  
    </section>  
      
    <!-- بخش تماس با ما -->  
    <section id="contact" class="section-card">  
      <div class="section-header">تماس با ما</div>  
      <div class="section-content">  
        <p>برای ارتباط با موسسه از ایمیل یا شبکه‌های اجتماعی استفاده کنید:</p>  
        <p>ایمیل: <a href="mailto:irtashacol@gmail.com">irtashacol@gmail.com</a></p>  
        <p>ایتا: <a href="https://eitaa.com/irtaali" target="_blank">eitaa.com/irtaali</a></p>  
      </div>  
    </section>  
  </main>  
    
  <!-- فوتر -->  
  <footer>  
    <p>© 2025 موسسه تعالی اندیشه و رشد | تمامی حقوق محفوظ است.</p>  
  </footer>  
    
  <!-- اسکریپت جهت فعال‌سازی منوی همبرگری و محو شدن لودینگ پس از بارگذاری صفحه -->  
  <script>  
    const menuToggle = document.querySelector('.menu-toggle');  
    const navMenu = document.querySelector('.nav-menu');  
      
    menuToggle.addEventListener('click', () => {  
      navMenu.classList.toggle('active');  
    });  
      
    window.addEventListener("load", function() {  
      // بلافاصله پس از بارگذاری کامل صفحه، لایه لودینگ با افکت fade-out محو می‌شود  
      document.getElementById("loader").classList.add("fade-out");  
      setTimeout(function(){  
        document.getElementById("loader").style.display = "none";  
      }, 500);  
    });  
  </script>
  
  <!-- ===============================
       کدهای مربوط به پنجره پاپ‌آپ اخبار
  ================================ -->
  <!-- HTML پنجره پاپ‌آپ و مودال تصویر -->  
  <div id="chatPopup">  
    <div class="popupContent">  
      <div class="popupHeader">آخرین اخبار</div>  
      <div class="popupBody" id="chatMessages">  
        <!-- نمایش انیمیشن لودینگ تا دریافت داده‌ها -->  
        <div class="loading">  
          <div class="spinner"></div>  
          <p>در حال بارگذاری...</p>  
        </div>  
      </div>  
      <!-- دکمه بستن جدید: دکمه گرد، سه بعدی، قرمز با ضربدر سفید، در سمت چپ قرار دارد -->  
      <div class="popupFooter" id="chatFooter">  
        <svg width="24" height="24" viewBox="0 0 24 24">  
          <path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12Z"/>  
        </svg>  
      </div>  
    </div>  
  </div>  

  <!-- HTML مودال تصویر (نمایش تصویر به صورت تمام‌صفحه) -->  
  <div id="imageModal">  
    <div class="imageModalContent">  
      <span class="closeModal" id="closeImageModal">  
        <svg width="24" height="24" viewBox="0 0 24 24">  
          <path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12Z"/>  
        </svg>  
      </span>  
      <img id="modalImage" src="" alt="Full Image">  
    </div>  
  </div>  

  <!-- کد جاوااسکریپت عملکرد پاپ‌آپ و مودال -->  
  <script>  
    (function(){  
      // جلوگیری از اسکرول صفحه اصلی هنگام نمایش پنجره پاپ‌آپ  
      document.body.style.overflow = "hidden";
      
      // لینک مستقیم فایل اکسل  
      const excelUrl = "https://docs.google.com/spreadsheets/d/1il6IPfhfVjw8YJKD1_VkZOxGS0eqmgvO3Z8nfP-1MwA/export?format=xlsx";  
      let chatMessagesData = [];  
  
      // تابع تبدیل لینک‌های گوگل درایو به لینک مناسب برای نمایش تصویر  
      function fixImageUrl(url) {  
        if(url.includes("drive.google.com")) {  
          const fileIdMatch = url.match(/\/d\/([^\/]+)/);  
          if(fileIdMatch && fileIdMatch[1]) {  
            return "https://drive.google.com/uc?export=view&id=" + fileIdMatch[1];  
          }  
        }  
        return url;  
      }  
  
      // تابع دریافت URL تصویر با کیفیت پایین  
      function getLowQualityImageUrl(url) {  
        let fixedUrl = fixImageUrl(url);
        if(!fixedUrl.includes("drive.google.com")){
          if(fixedUrl.indexOf('?') !== -1) {  
            return fixedUrl + "&lowq=1";  
          } else {  
            return fixedUrl + "?lowq=1";  
          }  
        } else {
          return fixedUrl;
        }
      }  
  
      // دریافت و پردازش داده‌های اکسل  
      async function fetchExcelData() {  
        try {  
          const response = await fetch(excelUrl);  
          if (!response.ok) throw new Error("خطا در دریافت فایل اکسل");  
          const arrayBuffer = await response.arrayBuffer();  
          const data = new Uint8Array(arrayBuffer);  
          const workbook = XLSX.read(data, { type: "array" });  
          const firstSheetName = workbook.SheetNames[0];  
          const worksheet = workbook.Sheets[firstSheetName];  
          // تبدیل شیت به آرایه‌ای دوبعدی (هر ردیف یک آرایه)  
          const rows = XLSX.utils.sheet_to_json(worksheet, { header: 1 });  
          // انتخاب ردیف‌هایی که حداقل ستون‌های A (عنوان)، B (توضیح) و C (لینک تصویر) را دارند  
          let validRows = rows.filter(row => row && row.length >= 3 && row[0] && row[1] && row[2]);  
          if(validRows.length > 10) {  
            validRows = validRows.slice(-10);  
          }  
          validRows.reverse(); // نمایش آخرین خبر در ابتدا  
          return validRows;  
        } catch (error) {  
          console.error("خطا در دریافت داده‌های اکسل:", error);  
          return [];  
        }  
      }  
  
      // ایجاد المان پیام چت از داده‌های یک ردیف  
      // ستون‌ها: A: عنوان، B: توضیح، C: لینک تصویر، D: لینک توضیحات بیشتر (اختیاری)، E: تاریخ خبر  
      function createChatMessage(row, index) {  
        const [title, desc, imgUrl, moreLink, newsDate] = row;  
        const messageDiv = document.createElement("div");  
        messageDiv.className = "chat-message";  
  
        // ایجاد تصویر پیام با کیفیت پایین  
        const img = document.createElement("img");  
        img.className = "chat-image";  
        img.dataset.full = imgUrl; // ذخیره لینک تصویر اصلی  
        img.src = getLowQualityImageUrl(imgUrl); // نمایش نسخه کم کیفیت  
        img.alt = title;  
        // fallback: در صورت خطا در بارگذاری نسخه کم کیفیت، از تصویر اصلی استفاده شود  
        img.onerror = function() {  
          this.onerror = null;  
          this.src = imgUrl;  
        };  
        // اگر تصویر قبلاً دیده شده باشد، کلاس viewed اضافه می‌شود  
        if(localStorage.getItem("image_seen_" + imgUrl)){  
          img.classList.add("viewed");  
        }  
        // با کلیک روی تصویر، مودال نمایش داده می‌شود و تصویر با کیفیت اصلی بارگیری می‌شود  
        img.addEventListener("click", function(){  
          openImageModal(imgUrl);  
          localStorage.setItem("image_seen_" + imgUrl, "true");  
          img.classList.add("viewed");  
        });  
        messageDiv.appendChild(img);  
  
        // عنوان پیام  
        const titleElem = document.createElement("div");  
        titleElem.className = "chat-title";  
        titleElem.textContent = title;  
        messageDiv.appendChild(titleElem);  
  
        // توضیحات پیام  
        const descElem = document.createElement("div");  
        descElem.className = "chat-desc";  
        descElem.textContent = desc;  
        messageDiv.appendChild(descElem);

        // افزودن تاریخ خبر در پایین توضیحات با فونت کوچکتر (در صورت وجود)
        if(newsDate && newsDate.toString().trim() !== "") {
          const dateElem = document.createElement("div");
          dateElem.className = "chat-date";
          dateElem.textContent = newsDate;
          dateElem.style.fontSize = "12px";
          dateElem.style.color = "#666";
          dateElem.style.textAlign = "left";
          dateElem.style.marginTop = "5px";
          messageDiv.appendChild(dateElem);
        }
  
        // دکمه «توضیحات بیشتر» در صورت وجود لینک در ستون D  
        if(moreLink && moreLink.toString().trim() !== ""){  
          const moreBtn = document.createElement("a");  
          moreBtn.className = "more-details";  
          moreBtn.textContent = "توضیحات بیشتر";  
          moreBtn.href = moreLink;  
          moreBtn.target = "_blank";  
          messageDiv.appendChild(moreBtn);  
        }  
        return messageDiv;  
      }  
  
      // بارگذاری پیام‌های چت در پنجره پاپ‌آپ  
      async function loadChatMessages() {  
        const data = await fetchExcelData();  
        chatMessagesData = data;  
        const chatMessagesContainer = document.getElementById("chatMessages");  
        chatMessagesContainer.innerHTML = "";  
        data.forEach((row, idx) => {  
          const messageElem = createChatMessage(row, idx);  
          chatMessagesContainer.appendChild(messageElem);  
        });  
      }  
  
      // نمایش مودال تصویر (تمام‌صفحه)  
      function openImageModal(imgUrl) {  
        document.getElementById("modalImage").src = imgUrl;  
        document.getElementById("imageModal").style.display = "flex";  
      }  
  
      // بستن مودال تصویر  
      function closeImageModal() {  
        document.getElementById("imageModal").style.display = "none";  
      }  
  
      // رویداد بستن پنجره پاپ‌آپ (دکمه جدید)  
      document.getElementById("chatFooter").addEventListener("click", function(){  
        document.getElementById("chatPopup").style.display = "none";  
        document.body.style.overflow = "auto";  
      });  
  
      // رویداد بستن مودال تصویر  
      document.getElementById("closeImageModal").addEventListener("click", closeImageModal);  
      document.getElementById("imageModal").addEventListener("click", function(e){  
        if(e.target === this) {  
          closeImageModal();  
        }  
      });  
  
      // بارگذاری پیام‌ها پس از آماده شدن صفحه  
      document.addEventListener("DOMContentLoaded", function(){  
        loadChatMessages();  
      });  
    })();  
  </script>  
</body>  
</html>
