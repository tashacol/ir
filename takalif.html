   <!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow">
  <title>سیستم ارسال تکالیف</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  <style>
    :root {
      --primary: #007bff; --primary-light: #e6f2ff; --primary-dark: #0056b3;
      --text-dark: #212529; --text-light: #6c757d; --text-on-dark: #ffffff;
      --bg-main: #f0f2f5; --bg-card: #ffffff; --border-color: #dee2e6;
      --success: #198754; --danger: #dc3545; --warning: #ffc107; --info: #0dcaf0;
      --shadow: 0 4px 25px rgba(0,0,0,0.08); --radius-lg: 16px; --radius-md: 12px;
      --transition: 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Vazirmatn', sans-serif;
      background-color: var(--bg-main);
      color: var(--text-dark);
      background-image: url('https://tashacol.ir/123.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Login View Styles */
    #login-view {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 20px;
      animation: fadeIn 0.5s;
    }
    .login-container {
      width: 100%;
      max-width: 420px;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 40px;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .login-container h1 { font-size: 1.8rem; margin-bottom: 8px; color: var(--text-dark); }
    .login-container p { color: var(--text-light); margin-bottom: 30px; }
    .input-wrapper { position: relative; margin-bottom: 25px; text-align: right; }
    .input-icon { position: absolute; top: 15px; right: 15px; color: var(--text-light); transition: var(--transition); z-index: 2; }
    .form-input { width: 100%; padding: 22px 55px 8px 15px; border: 1px solid #ced4da; border-radius: var(--radius-md); font-size: 1rem; outline: none; transition: var(--transition); background-color: #fff; color: var(--text-dark); }
    .form-label { position: absolute; right: 55px; top: 15px; color: var(--text-light); transition: var(--transition); pointer-events: none; background-color: #fff; padding: 0 5px; }
    .form-input:focus + .form-label, .form-input:not(:placeholder-shown) + .form-label { top: -10px; font-size: 0.85rem; color: var(--primary); }
    .form-input:focus { border-color: var(--primary); }
    .form-input:focus ~ .input-icon { color: var(--primary); }
    .btn-login { width: 100%; padding: 14px; font-size: 1.1rem; font-weight: 500; background: var(--primary); color: var(--text-on-dark); border: none; border-radius: var(--radius-md); cursor: pointer; transition: var(--transition); position: relative; min-height: 52px; display: flex; align-items: center; justify-content: center; }
    .btn-login:hover:not(:disabled) { background: var(--primary-dark); }

    /* Main Content View */
    #main-content-view {
        width: 100%;
        max-width: 1200px;
        margin: 1rem auto;
        padding: 40px;
        background-color: rgba(255, 255, 255, 0.85);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow);
        border: 1px solid rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        animation: fadeIn 0.6s ease-out;
    }
    .main-header { text-align: center; margin-bottom: 2rem; color: var(--text-dark); font-size: 2.2rem; font-weight: 700; }
    .main-header i { color: var(--primary); margin-left: 12px; }
    .ai-warning { background-color: rgba(255, 243, 205, 0.9); color: #664d03; border: 1px solid #ffecb5; border-radius: 10px; padding: 15px; margin: 0 auto 2rem auto; max-width: 700px; text-align: center; font-size: 0.95rem; line-height: 1.7; }
    .ai-warning i { margin-left: 8px; }
    .user-welcome { text-align: center; font-size: 1.6rem; font-weight: 500; margin-bottom: 2.5rem; }
    .user-welcome i { color: var(--success); margin-left: 10px; }
    .terms-grid { display: none; grid-template-columns: repeat(auto-fill, minmax(290px, 1fr)); gap: 30px; }
    .term-box {
      background: rgba(252, 252, 253, 0.95);
      border-radius: var(--radius-lg);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border: 1px solid rgba(0, 0, 0, 0.08);
      display: flex; flex-direction: column; overflow: hidden;
      transition: transform var(--transition), box-shadow var(--transition);
    }
    .term-box:hover { transform: translateY(-8px); box-shadow: 0 12px 28px rgba(0, 0, 0, 0.12); }
    .term-header { padding: 20px; border-bottom: 1px solid var(--border-color); background-color: rgba(255, 255, 255, 0.5); }
    .term-title { font-size: 1.6rem; font-weight: 700; margin: 0; }
    .term-due-date { font-size: 0.8rem; color: var(--text-light); margin-top: 5px; font-weight: 500; }
    .term-body { padding: 25px; flex-grow: 1; }
    .status-badge { display: flex; align-items: center; gap: 10px; font-size: 1.1rem; font-weight: 500; margin-bottom: 20px; }
    .status-badge i { font-size: 1.5rem; }
    .status-approved { color: var(--success); } .status-rejected { color: var(--danger); }
    .status-pending { color: #fd7e14; } .status-locked { color: var(--text-light); }
    .term-footer { padding: 20px; background-color: rgba(248, 249, 250, 0.8); border-top: 1px solid var(--border-color); }
    .term-btn { width: 100%; padding: 12px; border: none; border-radius: var(--radius-md); font-weight: bold; cursor: pointer; transition: all 0.2s; font-size: 0.95rem; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .btn-submit { background-color: var(--primary); color: white; }
    .btn-edit { background-color: var(--warning); color: var(--text-dark); }
    .btn-reason { background-color: var(--info); color: white; }
    .term-btn:disabled { background-color: #e9ecef; color: #adb5bd; cursor: not-allowed; }
    .term-btn:hover:not(:disabled) { transform: translateY(-2px); filter: brightness(1.1); }
    .loader { border: 5px solid #f3f3f3; border-top: 5px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 40px auto; }
    .overlay { display: none; position: fixed; z-index: 1000; inset: 0; background-color: rgba(0,0,0,0.5); backdrop-filter: blur(5px); animation: fadeIn 0.3s; }
    .overlay.active { display: flex; align-items: center; justify-content: center; }
    .popup-base { background-color: var(--bg-card); margin: auto; padding: 0; border-radius: var(--radius-lg); width: 90%; max-width: 600px; box-shadow: var(--shadow); animation: fadeIn 0.4s ease; overflow: hidden; }
    .popup-header { font-size: 1.5rem; font-weight: 600; padding: 20px 25px; background-color: #f8f9fa; border-bottom: 1px solid var(--border-color); display: flex; align-items: center; gap: 15px; }
    .popup-body { padding: 25px; max-height: 65vh; overflow-y: auto; }
    .popup-footer { padding: 20px 25px; background-color: #f8f9fa; text-align: left; border-top: 1px solid var(--border-color); display: flex; gap: 15px; justify-content: flex-end; }
    .popup-footer button { padding: 10px 25px; border-radius: var(--radius-md); font-size: 1rem; font-weight: bold; cursor: pointer; transition: all 0.2s; }
    .popup-footer .confirm-btn { background-color: var(--primary); color: white; border: none; }
    .popup-footer .cancel-btn { background-color: #e9ecef; color: var(--text-dark); border: 1px solid #dee2e6; }
    #submissionModal textarea { width: 100%; min-height: 200px; padding: 15px; border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s; resize: vertical; font-size: 1rem; font-family: inherit; box-sizing: border-box; }
    #submissionModal textarea:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2); outline: none; }
    .word-count { font-size: 0.9rem; color: #6c757d; text-align: left; margin-top: 8px; }
    .word-count.invalid { color: var(--danger); font-weight: bold; }
    .grecaptcha-badge { visibility: hidden; }
  </style>
</head>
<body>

  <div id="login-view">
    <div class="login-container">
        <h1>سیستم ارسال تکالیف</h1>
        <p>لطفاً برای ورود کد ملی خود را وارد کنید</p>
        <div class="input-wrapper">
            <input type="text" id="nationalCodeInput" class="form-input" placeholder=" " required inputmode="numeric">
            <label for="nationalCodeInput" class="form-label">کد ملی</label>
            <i class="fas fa-id-card input-icon"></i>
        </div>
        <button id="checkBtn" class="btn-login" onclick="handleLoginClick()"><span class="btn-text">بررسی و ورود</span></button>
    </div>
  </div>

  <div id="main-content-view" style="display: none;">
    <h2 class="main-header"><i class="fas fa-tasks"></i>سیستم ارسال تکالیف</h2>
    <div class="ai-warning"><i class="fas fa-exclamation-triangle"></i> هرگونه تقلب شرعا حرام بوده و این سیستم مجهز به هوش مصنوعی است و در صورتیکه جواب از هوش مصنوعی اخذ شده باشد توسط سیستم تشخیص داده شده و رد می‌شود.</div>

    <div id="loader" class="loader" style="display: none;"></div>
    <div id="userInfo" style="display: none;"><h3 id="userName" class="user-welcome"></h3></div>
    <div id="termsGrid" class="terms-grid"></div>
  </div>


  <!-- پاپ‌آپ‌ها بدون تغییر در عملکرد باقی می‌مانند -->
  <div id="submissionModalOverlay" class="overlay">
    <div id="submissionModal" class="popup-base">
      <div id="submissionModalHeader" class="popup-header"></div>
      <div class="popup-body">
        <div><strong><i class="fas fa-question-circle"></i> سوال:</strong></div>
        <p id="submissionModalQuestion" style="white-space: pre-wrap; background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;"></p>
        <form id="submissionForm" style="margin-top: 20px;">
          <input type="hidden" id="termNumber">
          <label for="answerText"><strong><i class="fas fa-pen-alt"></i> پاسخ شما:</strong></label>
          <textarea id="answerText" required placeholder="متن تکلیف خود را اینجا وارد کنید" style="margin-top: 10px;"></textarea>
          <div id="wordCount" class="word-count">تعداد کلمات: 0</div>
        </form>
      </div>
      <div class="popup-footer">
        <button type="button" class="cancel-btn" onclick="closeSubmissionModal()">انصراف</button>
        <button type="submit" form="submissionForm" id="submitBtn" class="confirm-btn">ارسال تکلیف</button>
      </div>
    </div>
  </div>
  <div id="reasonModalOverlay" class="overlay">
    <div id="reasonModal" class="popup-base">
      <div class="popup-header"><i class="fas fa-info-circle"></i> دلیل رد تکلیف</div>
      <div class="popup-body"><div id="reasonModalContent"></div></div>
      <div class="popup-footer"><button type="button" class="confirm-btn" onclick="closeReasonModal()">متوجه شدم</button></div>
    </div>
  </div>
  <div id="approvedSubmissionModalOverlay" class="overlay">
    <div id="approvedSubmissionModal" class="popup-base">
      <div class="popup-header"><i class="fas fa-check-circle"></i> متن تکلیف تایید شده</div>
      <div class="popup-body"><p id="approvedSubmissionContent"></p></div>
      <div class="popup-footer"><button type="button" class="confirm-btn" onclick="closeApprovedSubmissionModal()">بستن</button></div>
    </div>
  </div>
  <div id="messageModalOverlay" class="overlay">
    <div id="messageModal" class="popup-base">
      <div id="messageModalHeader" class="popup-header"></div>
      <div class="popup-body"><p id="messageModalContent" style="font-size: 1.1rem; text-align: center;"></p></div>
      <div class="popup-footer"><button type="button" class="confirm-btn" onclick="closeMessageModal()">تایید</button></div>
    </div>
  </div>
  
  <div class="g-recaptcha" data-sitekey="6Lc1vqkrAAAAAHLHbzPMzlREvKwgHDNSmakrB-aq" data-size="invisible" data-callback="onRecaptchaSuccess"></div>

  <script>
    // ━━━━━ JAVASCRIPT LOGIC IS UNCHANGED ━━━━━
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwM6QPomqlgoIvgPq7CsWhTBAhgB-EbsIyOnPLClRzFFS2rhvzo89jh7AsW8znGAe9s/exec";
    const nationalCodeInput = document.getElementById('nationalCodeInput');
    const loader = document.getElementById('loader');
    const termsGrid = document.getElementById('termsGrid');
    const userInfo = document.getElementById('userInfo');
    const userNameEl = document.getElementById('userName');
    const submissionForm = document.getElementById('submissionForm');
    const answerTextarea = document.getElementById('answerText');
    const wordCountDisplay = document.getElementById('wordCount');
    const submissionModalOverlay = document.getElementById('submissionModalOverlay');
    const reasonModalOverlay = document.getElementById('reasonModalOverlay');
    const messageModalOverlay = document.getElementById('messageModalOverlay');
    const approvedSubmissionModalOverlay = document.getElementById('approvedSubmissionModalOverlay');
    const loginView = document.getElementById('login-view');
    const mainContentView = document.getElementById('main-content-view');

    let userData = {};
    let sessionToken = null;

    document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const nationalCodeFromId = params.get('id');
        if (nationalCodeFromId && /^\d{10}$/.test(nationalCodeFromId)) {
            loginView.style.display = 'none';
            mainContentView.style.display = 'block';
            loader.style.display = 'block';
            nationalCodeInput.value = nationalCodeFromId;
            grecaptcha.ready(() => { grecaptcha.execute(); });
        }
    });

    answerTextarea.addEventListener('input', () => {
      const text = answerTextarea.value.trim();
      const words = text.split(/\s+/).filter(word => word.length > 0);
      wordCountDisplay.textContent = `تعداد کلمات: ${words.length}`;
      wordCountDisplay.classList.toggle('invalid', words.length < 200 || words.length > 1500);
    });

    function showSubmissionModal(term) {
      document.getElementById('termNumber').value = term;
      document.getElementById('submissionModalHeader').innerHTML = `<i class="fas fa-upload"></i> ارسال تکلیف ترم ${term}`;
      document.getElementById('submissionModalQuestion').textContent = userData.questions[term] || 'سوالی برای این ترم تعریف نشده است.';
      answerTextarea.value = userData.submissions[term]?.answer || '';
      answerTextarea.dispatchEvent(new Event('input'));
      submissionModalOverlay.classList.add('active');
    }
    function closeSubmissionModal() { submissionModalOverlay.classList.remove('active'); }
    function showReasonModal(term) {
      const reason = userData.submissions[term]?.reason || 'دلیلی ثبت نشده است.';
      document.getElementById('reasonModalContent').innerHTML = renderMarkdown(reason);
      reasonModalOverlay.classList.add('active');
    }
    function closeReasonModal() { reasonModalOverlay.classList.remove('active'); }
    function showMessageModal(title, message) {
      document.getElementById('messageModalHeader').innerText = title;
      document.getElementById('messageModalContent').innerText = message;
      messageModalOverlay.classList.add('active');
    }
    function closeMessageModal() { messageModalOverlay.classList.remove('active'); }
    function showApprovedSubmissionModal(term) {
      const answer = userData.submissions[term]?.answer || 'متن تکلیفی یافت نشد.';
      document.getElementById('approvedSubmissionContent').textContent = answer;
      approvedSubmissionModalOverlay.classList.add('active');
    }
    function closeApprovedSubmissionModal() { approvedSubmissionModalOverlay.classList.remove('active'); }

    function handleLoginClick() {
        const nationalCode = nationalCodeInput.value.trim();
        if (!/^\d{10}$/.test(nationalCode)) {
            return showMessageModal("خطا", "کد ملی وارد شده معتبر نیست.");
        }
        loginView.style.display = 'none';
        mainContentView.style.display = 'block';
        loader.style.display = 'block';
        termsGrid.style.display = 'none';
        userInfo.style.display = 'none';
        grecaptcha.ready(() => { grecaptcha.execute(); });
    }

    async function onRecaptchaSuccess(recaptchaToken) {
      const nationalCode = nationalCodeInput.value.trim();
      try {
        const response = await fetch(WEB_APP_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'text/plain;charset=utf-8' },
          body: JSON.stringify({ action: 'login', nationalCode, recaptchaToken })
        });
        if (!response.ok) throw new Error(`خطای شبکه (کد: ${response.status})`);
        const data = await response.json();
        if (data.success && data.sessionToken) {
          sessionToken = data.sessionToken;
          displayData(data);
        } else {
          handleError({ message: data.error || "خطای نامشخص از سرور." });
        }
      } catch (error) { 
        handleError(error); 
      } finally {
        grecaptcha.reset();
      }
    }

    function displayData(data) {
      loader.style.display = 'none';
      if (data.error && !data.success) {
        mainContentView.style.display = 'none';
        loginView.style.display = 'flex';
        return showMessageModal("وضعیت دوره", data.error);
      }
      loginView.style.display = 'none';
      mainContentView.style.display = 'block';
      userData = data;
      userNameEl.innerHTML = `<i class="fas fa-user-check"></i> خوش آمدید، ${data.name}!`;
      userInfo.style.display = 'block';
      termsGrid.innerHTML = '';
      const lastApprovedTerm = Math.max(0, ...Object.keys(data.submissions).filter(t => data.submissions[t].status == 5).map(Number));
      const totalTerms = Object.keys(data.termDetails).length;
      for (let term = 1; term <= totalTerms; term++) {
        const submission = data.submissions[term];
        const details = data.termDetails[term];
        const prevTermApproved = (term === 1 || lastApprovedTerm >= term - 1);
        let statusIcon, statusText, statusClass, buttonsHTML, dueDateHTML = '';
        if (details.isUnlocked) {
            dueDateHTML = `<div class="term-due-date">آخرین مهلت: ${details.dueDate}</div>`;
            const canSubmit = prevTermApproved;
            if (submission) {
                if (submission.status == 5) {
                    statusIcon = 'fa-check-circle'; statusText = 'تأیید شده'; statusClass = 'status-approved';
                    buttonsHTML = `<button class="term-btn" disabled><i class="fas fa-check"></i> تأیید شده</button>`;
                    buttonsHTML += `<button class="term-btn btn-reason" style="margin-top: 10px;" onclick="showApprovedSubmissionModal(${term})"><i class="fas fa-eye"></i> مشاهده تکلیف</button>`;
                } else if (submission.status == 0) {
                    statusIcon = 'fa-times-circle'; statusText = 'تأیید نشده'; statusClass = 'status-rejected';
                    buttonsHTML = `<button class="term-btn btn-edit" onclick="showSubmissionModal(${term})"><i class="fas fa-pencil-alt"></i> ویرایش تکلیف</button>`;
                    if (submission.reason) { buttonsHTML += `<button class="term-btn btn-reason" style="margin-top: 10px;" onclick="showReasonModal(${term})"><i class="fas fa-eye"></i> مشاهده دلیل</button>`; }
                } else {
                    statusIcon = 'fa-hourglass-half'; statusText = 'در حال بررسی'; statusClass = 'status-pending';
                    buttonsHTML = `<button class="term-btn" disabled><i class="fas fa-spinner fa-spin"></i> در حال بررسی</button>`;
                }
            } else {
                if (canSubmit) {
                    statusIcon = 'fa-clock'; statusText = 'آماده ارسال'; statusClass = 'status-pending';
                    buttonsHTML = `<button class="term-btn btn-submit" onclick="showSubmissionModal(${term})"><i class="fas fa-paper-plane"></i> ارسال تکلیف</button>`;
                } else {
                    statusIcon = 'fa-lock'; statusText = 'منتظر تأیید ترم قبل'; statusClass = 'status-locked';
                    buttonsHTML = `<button class="term-btn" disabled><i class="fas fa-lock"></i> منتظر تأیید ترم قبل</button>`;
                }
            }
        } else {
            statusIcon = 'fa-lock'; statusText = 'قفل شده'; statusClass = 'status-locked';
            buttonsHTML = `<button class="term-btn" disabled><i class="fas fa-lock"></i> بازگشایی در ${details.unlockDate}</button>`;
        }
        const termBox = document.createElement('div');
        termBox.className = 'term-box';
        termBox.innerHTML = `<div class="term-header"><h3 class="term-title">ترم ${term}</h3>${dueDateHTML}</div><div class="term-body"><div class="status-badge ${statusClass}"><i class="fas ${statusIcon}"></i><span>${statusText}</span></div></div><div class="term-footer">${buttonsHTML}</div>`;
        termsGrid.appendChild(termBox);
      }
      termsGrid.style.display = 'grid';
    }
    
    submissionForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!sessionToken) { return showMessageModal("خطا", "نشست شما معتبر نیست. لطفاً صفحه را رفرش کنید."); }
      const term = document.getElementById('termNumber').value;
      const answer = answerTextarea.value.trim();
      const words = answer.split(/\s+/).filter(word => word.length > 0);
      if (words.length < 200 || words.length > 1500) { return showMessageModal("خطا", "تعداد کلمات پاسخ شما باید بین ۲۰۰ تا ۱۵۰۰ کلمه باشد."); }
      const submitBtn = document.getElementById('submitBtn');
      const originalBtnHTML = submitBtn.innerHTML;
      submitBtn.disabled = true;
      submitBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> در حال ارسال...`;
      const payload = { action: 'submitAssignment', sessionToken: sessionToken, formData: { term, answer } };
      try {
        const response = await fetch(WEB_APP_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'text/plain;charset=utf-8' },
          body: JSON.stringify(payload)
        });
        if (!response.ok) throw new Error(`خطای شبکه (کد: ${response.status})`);
        const result = await response.json();
        closeSubmissionModal();
        showMessageModal(result.success ? "موفقیت" : "توجه", result.message || "پاسخ نامشخص از سرور.");
        if (result.updatedData && result.updatedData.success) {
            displayData(result.updatedData);
        } else if (result.message.includes("نشست")) {
            window.location.reload();
        }
      } catch (error) {
        handleError(error);
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnHTML;
      }
    });

    function handleError(error) {
      loader.style.display = 'none';
      mainContentView.style.display = 'none';
      loginView.style.display = 'flex';
      showMessageModal("خطای اتصال", 'خطا در ارتباط با سرور: ' + error.message);
    }

    function renderMarkdown(text) {
      let html = text.replace(/</g, "&lt;").replace(/>/g, "&gt;");
      html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
      html = html.replace(/^\* (.*$)/gm, '<li>$1</li>');
      if (html.includes('<li>')) { html = '<ul>' + html.replace(/<\/li>\s*<li>/g, '</li><li>') + '</ul>'; }
      return html.replace(/\n/g, '<br>');
    }

    window.onclick = (event) => {
      if (event.target == submissionModalOverlay) closeSubmissionModal();
      if (event.target == reasonModalOverlay) closeReasonModal();
      if (event.target == messageModalOverlay) closeMessageModal();
      if (event.target == approvedSubmissionModalOverlay) closeApprovedSubmissionModal();
    }
    nationalCodeInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') { event.preventDefault(); document.getElementById('checkBtn').click(); } });
  </script>

</body>
</html>
